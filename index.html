<html>
	<head>
		<title>clarkson</title>
		<style>
			body { margin:0 ; }
			canvas { width: 100%; height: 100% }
		</style>
	</head>
	<body>
		<script src="js/three.min.js">   </script>
		<script>

      var currentAlpha = 0;
      var currentBeta = 0;
      var currentGamma = 0;
      var newAlpha = 0;
      var newBeta = 0;
      var newGamma = 0;

			var scene = new THREE.Scene();
      var camera = new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,0.1,1000);
      var renderer = new THREE.WebGLRenderer();
      renderer.setClearColor(0xE5F2F9,1);
			renderer.setSize( window.innerWidth, window.innerHeight );

      scene.add(camera);      

      var axis = new THREE.AxisHelper(10);
      scene.add(axis);

      var cubeGeometry = new THREE.BoxGeometry(5,5,5);
      var cubeMaterial = new THREE.MeshBasicMaterial({color:0xdddddd,wireframe:true});
      var cube = new THREE.Mesh(cubeGeometry,cubeMaterial);
      var droplet,floor;

      cube.position.x = 0;
      cube.position.y = 0;
      cube.position.z = 0;

      scene.add(cube);


      floor = new THREE.Mesh(new THREE.PlaneBufferGeometry(500,500), new THREE.MeshLambertMaterial({map: THREE.ImageUtils.loadTexture('images/shower_tile2.jpg')}));
      scene.add(floor);

      camera.position.x = 0;    
      camera.position.y = 250;
      camera.position.z = 500;
      camera.lookAt(scene.floor);

      var light = new THREE.AmbientLight(0xffffff);
      scene.add(light);


      var loader = new THREE.JSONLoader();
      loader.load("models/dropplet4.js",function(geometry,materials){
        var material = new THREE.MeshFaceMaterial(materials);
        droplet = new THREE.Mesh(geometry,material);

        droplet.position.x = 0;
        droplet.position.y = 0;
        droplet.position.z = 40;
        droplet.rotation.z = Math.PI/4;

        droplet.scale.set(20,20,20);
        scene.add(droplet);
        //var light = new THREE.PointLight(0xffffff);
        //light.position.set(-250,200,100);
        //scene.add(light);
      });

			document.body.appendChild( renderer.domElement );
			var render = function () {
				requestAnimationFrame( render );
      
        droplet.translateY(-newBeta*Math.abs(newBeta)/250.0);
        droplet.translateX(newGamma*Math.abs(newGamma)/250.0);
       // droplet.rotation.z(newAlpha*Math.PI/180);
       // droplet.rotation.y += 0.1;
				renderer.render(scene, camera);
			};

      var handleOrientation = function(event){
          newAlpha = event.alpha;
          newBeta = event.beta;
          newGamma = event.gamma;
      };

      
      window.addEventListener("deviceorientation",handleOrientation,true);

			render();
		</script>
	</body>
</html>
